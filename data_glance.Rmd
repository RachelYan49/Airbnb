---
title: "data_glance"
date: "10/9/2018"
output: html_document
---

```{r}
install.packages("tidyverse")
library(tidyverse)
library(dplyr)
```

```{r}
library(readxl) ## reading the excel 
library(stringr)
listings <- read_excel("Clb.xlsx", skip = 1) #from albert 

```

##### data cleaning 
###### getting park out of amenities
```{r}
data_raw <- listings %>%
select(neighbourhood_cleansed,room_type,accommodates,square_feet,extra_people,minimum_nights,instant_bookable, amenities, price) %>%
  mutate(parking = str_detect(amenities, "park"))
```
###### getting rid of dollar signs

```{r}

data_cleaned <- data_raw %>%  #from albert
  mutate(
    price = str_replace_all(price, "\\$", ""),
    price = str_replace_all(price, ",", ""),
    price = as.numeric(price)
    )

ggplot(data_cleaned, aes(x=price)) +
  geom_histogram() +
  scale_x_log10()

ggplot(data_cleaned, aes(x=room_type, y =price))  + 
  geom_boxplot() + 
  scale_y_log10()

lm(price~room_type, data = data_cleaned) %>% summary()
```

##### regression models with all

```{r}
cor_data <-  data_cleaned %>% 
  select(accommodates,extra_people,minimum_nights,price) #only on numerical
cor(cor_data)
```


```{r}

mod1 <- lm(price~accommodates + instant_bookable + minimum_nights + room_type+ neighbourhood_cleansed + extra_people, data_cleaned) #when square feet added, no one is significant lol
summary(mod1)
```

```{r}
mod2 <- lm(price~accommodates + instant_bookable + room_type+ neighbourhood_cleansed + extra_people, data_cleaned)
summary(mod2)
```

```{r}
# mean price of the accomodation by district
MeanP_by_district <- data_cleaned %>% 
  group_by(neighbourhood_cleansed) %>% 
  summarise(price=mean(price))

#Histogram of mean price

ggplot(MeanP_by_district,mapping = aes(x=neighbourhood_cleansed,y=price))+geom_col()+
  coord_flip() 

#Boxplot of the median price for each district

ggplot(data_cleaned, aes(x=neighbourhood_cleansed, y =price))  + 
  geom_boxplot() + 
  scale_y_log10()+ coord_flip()



```

# Using the . in the formula interface includes all non-response variables in the data frame.
